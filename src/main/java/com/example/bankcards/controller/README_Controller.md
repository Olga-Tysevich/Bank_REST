# Контроллеры

**Модуль реализует REST API для управления банковскими картами и аутентификацией пользователей. 
Он используется в системах, где требуется централизованное управление пользовательскими картами и безопасная авторизация.**

---

### Аутентификация (`AuthController`)

Контроллер отвечает за работу с access/refresh токенами и включает следующие эндпоинты:

| Метод | Endpoint               | Описание                                                                     |
| ----- | ---------------------- | ---------------------------------------------------------------------------- |
| POST  | `/v1/api/auth/login`   | Авторизация пользователя и генерация токенов. Refresh-токен в cookie.        |
| POST  | `/v1/api/auth/logout`  | Удаление refresh-токена из cookie и завершение сессии.                       |
| POST  | `/v1/api/auth/refresh` | Обновление access и refresh токенов. Токен читается из cookie или заголовка. |

Особенности:

* Refresh-токен устанавливается в `httpOnly` cookie.
* Поддержка обновления токенов через заголовок `Authorization`.

---

### Управление картами (`CardController`)

Контроллер предоставляет административный интерфейс для работы с банковскими картами:

| Метод  | Endpoint                                  | Описание                                              |
| ------ | ----------------------------------------- | ----------------------------------------------------- |
| POST   | `/v1/api/card/add`                        | Добавление новой карты.                               |
| POST   | `/v1/api/card/admin/update`               | Обновление информации по карте.                       |
| POST   | `/v1/api/card/admin/update/{id}/{status}` | Изменение статуса карты (`ACTIVE`, `BLOCKED` и т.д.). |
| DELETE | `/v1/api/card/admin/delete/{id}`          | Удаление карты по ID.                                 |
| GET    | `/v1/api/card/get/{id}`                   | Получение карты по ID.                                |
| GET    | `/v1/api/card/get`                        | Получение списка карт с фильтрацией и пагинацией.     |

Особенности:

* Поддержка ролей через Spring Security, например (`ROLE_ADMIN`).
* Поддержка фильтров и поиска по различным параметрам.
* Генерация OpenAPI-документации с помощью Swagger v3.

---

### Технологии

* `Spring Boot`
* `Spring Security`
* `Jakarta Validation`
* `Lombok`
* `OpenAPI (Swagger 3)`

---

### Безопасность

* Все операции, связанные с модификацией карт доступны только пользователям с ролью `ROLE_ADMIN`.
* Все операции, связанные с получением карт доступны пользователям с ролями `ROLE_ADMIN` и `ROLE_ADMIN`(только собственные карты).
* Refresh-токены защищены через `httpOnly` и `Secure` cookies.

---

> Полная документация API доступна в Swagger UI после запуска приложения:
> `http://localhost:8080/swagger-ui/index.html`

---
